package com.ufgov.zc.client.zc.formula;import java.util.ArrayList;import java.util.List;import com.ufgov.zc.client.common.LangTransMeta;import com.ufgov.zc.client.common.ServiceFactory;import com.ufgov.zc.client.common.WorkEnv;import com.ufgov.zc.common.system.RequestMeta;import com.ufgov.zc.common.zc.model.ZcEbFormula;import com.ufgov.zc.common.zc.model.ZcEbFormulaItem;import com.ufgov.zc.common.zc.model.ZcEbFormulaParam;import com.ufgov.zc.common.zc.publish.IZcEbFormulaServiceDelegate;/** * * @ClassName: ExportFormulaDescribe* @Description: TODO(这里用一句话描述这个类的作用)* @date: 2010-7-22 下午04:59:57* @version: V1.0 * @since: 1.0* @author: Administrator* @modify: */public class ExportFormulaDescribe {  private ZcEbFormula zcEbFormula;  private int weight = 900;//列宽  private int fontSize;//字体的大小  static {    LangTransMeta.init("ZC%");  }  public ExportFormulaDescribe(ZcEbFormula zcEbFormula) {    this.zcEbFormula = zcEbFormula;  }  private String htmlHead() {    String htmlHead = "<HTML><Head><title>评标方法</title></head><body><table border=\"1\" cellspacing=\"0\" bordercolor=\"#000000\" cellpadding=\"0\" style=\"border-collapse: collapse\">"      + "<tr><td align=\"center\" width=\""      + weight      / 6      + "px\">类别</td><td width=\""      + weight      * 4      / 6      + "px\" align=\"center\">评标标准</td><td width=\"" + weight / 6 + "px\" align=\"center\">分值</td></tr>";    return htmlHead;  }  private String htmlTail() {    String htmlTail = "</table></body></html>";    return htmlTail;  }  public String exportFormula() {    StringBuffer str = new StringBuffer();    str.append(htmlHead());    str.append(exportFormulaItem("SC"));    str.append(htmlTail());    return str.toString();  }  public String exportParam() {    StringBuffer str = new StringBuffer();    for (int i = 0; i < zcEbFormula.getParamList().size(); i++) {      ZcEbFormulaParam zcEbFormulaParam = (ZcEbFormulaParam) zcEbFormula.getParamList().get(i);      str.append("\t" + (i + 1) + " " + "参数名称" + zcEbFormulaParam.getParamName() + "\n");      str.append("\t参数默认值" + zcEbFormulaParam.getDefaultValue() + "\n");      if (null != zcEbFormulaParam.getDescription()) {        str.append("\t描述" + zcEbFormulaParam.getDescription() + "\n");      }    }    return str.toString();  }  public String exportFormulaItem(String parentItemCode) {    StringBuffer str = new StringBuffer();    List list = new ArrayList();    //获得顶级指标     for (int i = 0; i < zcEbFormula.getItemList().size(); i++) {      if (((ZcEbFormulaItem) zcEbFormula.getItemList().get(i)).getParentItemCode().equals(parentItemCode)) {        list.add(zcEbFormula.getItemList().get(i));      }    }    if (list == null || list.size() == 0) {      return "";    }    for (int i = 0; i < list.size(); i++) {      ZcEbFormulaItem bean = (ZcEbFormulaItem) list.get(i);      str.append("<tr>" + "<td width=\"\">" + bean.getName() + "</td>" + "<td>");      if ("".equals(exportChildFormulaItem(bean.getItemCode(), 2))) {        str.append(bean.getDescription());      } else {        str.append(exportChildFormulaItem(bean.getItemCode(), 2));      }      str.append("</td>" + "<td>" + bean.getStandardScore() + "</td>" + "</tr>");    }    return str.toString();  }  public String exportChildFormulaItem(String parentItemCode, int level) {    StringBuffer str = new StringBuffer();    List list = new ArrayList();    //获得顶级指标     for (int i = 0; i < zcEbFormula.getItemList().size(); i++) {      if (((ZcEbFormulaItem) zcEbFormula.getItemList().get(i)).getParentItemCode().equals(parentItemCode)) {        list.add(zcEbFormula.getItemList().get(i));      }    }    if (list == null || list.size() == 0) {      return "";    }    int nextlevel = level + 1;    str    .append("<table  border=\"1\" cellspacing=\"0\" bordercolor=\"#000000\" cellpadding=\"0\" style=\"border-collapse: collapse\">");    for (int i = 0; i < list.size(); i++) {      ZcEbFormulaItem bean = (ZcEbFormulaItem) list.get(i);      str.append("<tr>" + "<td width=\"" + weight * (Math.pow(0.333, level)) + "px\">" + bean.getName()      + "</td>" + "<td width=\"" + weight * (Math.pow(0.666, level)) + "px\">");      if ("".equals(exportChildFormulaItem(bean.getItemCode(), nextlevel))) {        str.append(bean.getDescription());      } else {        str.append(exportChildFormulaItem(bean.getItemCode(), nextlevel));      }      str.append("</td>" + "<td width=\"" + weight * (Math.pow(0.333, level)) + "px\">"      + bean.getStandardScore() + "</td></tr>");    }    str.append("</table>");    return str.toString();  }}