/**   * @(#) project: ZFCG* @(#) file: evalDataService.java* * Copyright 2011 UFGOV, Inc. All rights reserved.* UFGOV PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.* */package com.ufgov.zc.client.zc.expertEval.service;import com.ufgov.zc.client.common.ServiceFactory;import com.ufgov.zc.client.common.WorkEnv;import com.ufgov.zc.common.system.RequestMeta;import com.ufgov.zc.common.system.dto.ElementConditionDto;import com.ufgov.zc.common.zc.model.EvalExpert;import com.ufgov.zc.common.zc.model.EvalItemType;import com.ufgov.zc.common.zc.model.EvalPackProvider;import com.ufgov.zc.common.zc.model.ZcEbEvalPack;import com.ufgov.zc.common.zc.publish.IZcEbEvalServiceDelegate;import com.ufgov.zc.common.zc.publish.IZcEbFormulaServiceDelegate;import java.util.ArrayList;import java.util.HashMap;import java.util.List;import java.util.Map;/*** @ClassName: evalDataService* @Description: 评审数据的处理类* @date: 2011-6-3 下午04:40:24* @version: V1.0 * @since: 1.0* @author: fanpl* @modify: */public class EvalDataService {  private Map paramMap;  private RequestMeta requestMeta = WorkEnv.getInstance().getRequestMeta();  private IZcEbEvalServiceDelegate zcEbEvalServiceDelegate = (IZcEbEvalServiceDelegate) ServiceFactory.create(IZcEbEvalServiceDelegate.class,  "zcEbEvalServiceDelegate");  private IZcEbFormulaServiceDelegate zcEbFormulaServiceDelegate = (IZcEbFormulaServiceDelegate) ServiceFactory.create(  IZcEbFormulaServiceDelegate.class, "zcEbFormulaServiceDelegate");  public EvalDataService() {  }  public void initParams(ZcEbEvalPack evalPack) {    paramMap.put("PROJ_CODE", evalPack.getProjCode());    paramMap.put("PACK_CODE", evalPack.getPackCode());    paramMap.put("FORMULA_CODE", evalPack.getFormulaCode());  }  public List getZcEbEvalPackList(ElementConditionDto dto, RequestMeta meta) {    return zcEbEvalServiceDelegate.getZcEbEvalPackList(dto, meta);  }  public List getEvalParamResultList() {    return zcEbEvalServiceDelegate.getEvalParamList(paramMap, requestMeta);  }  private void setEvalExpert(ZcEbEvalPack evalPack) {    Map<String, String> param = new HashMap<String, String>();    /**     * 专家以用户的方式登录:     */    EvalExpert evalExpert = new EvalExpert();    evalExpert.setExpertCode(requestMeta.getSvUserID());    evalExpert.setExpertName(requestMeta.getEmpName());    /**     * 预算单位代表登陆     *      */    if (requestMeta.getSvCoCode().equals(evalPack.getPack().getCoCode())) {      //只能有一个采购人代表      evalExpert.setExpertCode(requestMeta.getSvCoCode());      evalExpert.setExpertName("采购人代表");    }    evalPack.setEvalExpert(evalExpert);  }  public List getProviderDataList(ZcEbEvalPack evalPack, String formulaType) {    //取供应商的评审数据    Map providerSelectMap = new HashMap();    providerSelectMap.put("PACK_CODE", evalPack.getPackCode());    providerSelectMap.put("PROJ_CODE", evalPack.getProjCode());    if (formulaType.equals(EvalItemType.SCORE)) {      providerSelectMap.put("ITEM_TYPE", EvalItemType.SCORE);      providerSelectMap.put("FILTER_BY_COMPLIANCE_RES", "Y");    } else {      providerSelectMap.put("ITEM_TYPE", EvalItemType.COMPLIANICE);    }    providerSelectMap.put("FORMULA_CODE", evalPack.getFormulaCode());    providerSelectMap.put("EVAL_EXPERT_CODE", evalPack.getEvalExpert().getExpertCode());    List<EvalPackProvider> providerDataList = new ArrayList<EvalPackProvider>();    List list = zcEbEvalServiceDelegate.getEvalPackProviderList(providerSelectMap, requestMeta);    if (null != list && !list.isEmpty()) {      providerDataList.addAll(list);    }    return providerDataList;  }}