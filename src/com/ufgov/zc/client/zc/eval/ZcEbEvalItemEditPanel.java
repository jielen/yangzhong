/**   * @(#) project: ZC* @(#) file: ZcEbEvalItemEditPanel.java* * Copyright 2010 UFGOV, Inc. All rights reserved.* UFGOV PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.* */package com.ufgov.zc.client.zc.eval;import java.awt.Color;import java.awt.Font;import java.beans.PropertyChangeEvent;import java.beans.PropertyChangeListener;import java.io.File;import java.util.List;import javax.swing.BorderFactory;import javax.swing.JComponent;import javax.swing.JSplitPane;import javax.swing.JTabbedPane;import javax.swing.border.TitledBorder;import com.ufgov.zc.client.component.JFuncToolBar;import com.ufgov.zc.client.component.button.FuncButton;import com.ufgov.zc.client.component.button.NextButton;import com.ufgov.zc.client.component.button.PreviousButton;import com.ufgov.zc.client.component.ui.fieldeditor.AbstractFieldEditor;import com.ufgov.zc.client.component.zc.AbstractMainSubEditPanel;import com.ufgov.zc.client.zc.WordFileUtil;import com.ufgov.zc.client.zc.ztb.activex.WordPane;import com.ufgov.zc.common.zc.model.ZcEbEvalItemResult;/*** @ClassName: ZcEbEvalItemEditPanel* @Description: TODO(这里用一句话描述这个类的作用)* @date: 2010-12-10 下午04:58:38* @version: V1.0 * @since: 1.0* @author: fanpl* @modify: */public abstract class ZcEbEvalItemEditPanel extends AbstractMainSubEditPanel {  private ZcEbEvalItemEditPanel self = this;  private WordPane wordPane = new WordPane();  private String compoId = "ZC_EB_EVAL_PACK";  private String fileName;  private JTabbedPane tabPane = new JTabbedPane();  private EvalFormulaTreeNode eidtNode;  private ZcEbEvalItemResult zcEbEvalItemResult;  public EvalFormulaTreePanel treePanel;  private JSplitPane splitPanel = new JSplitPane(JSplitPane.VERTICAL_SPLIT);  public FuncButton previousButton = new PreviousButton();  public FuncButton nextButton = new NextButton();  //招投标文件存放路径根目录  protected static final String ZTB_FILE_ROOT_PATH = EvalFilePathUtil.ZTB_FILE_ROOT_PATH;  //招标文件存放路径根目录  protected static final String ZB_FILE = EvalFilePathUtil.ZB_FILE;  //投标文件存放路径根目录  protected static final String TB_FILE = EvalFilePathUtil.TB_FILE;  private String ztbFileName = "C:\\ufgovzceb\\resource\\impfiles\\projects.xml";  public abstract List<AbstractFieldEditor> createFieldEditors();  public JComponent createSubBillPanel() {    return tabPane;  }  public void initToolBar(JFuncToolBar toolBar) {  }  public ZcEbEvalItemEditPanel() {    this.workPanel.setBorder(BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(), "专家评审", TitledBorder.CENTER, TitledBorder.TOP,    new Font("宋体", Font.BOLD, 15), Color.BLUE));    this.colCount = 3;    init();    addSubPane();  }  public ZcEbEvalItemEditPanel(EvalFormulaTreeNode evalFormulaTreeNode) {    workPanel.setBorder(BorderFactory.createTitledBorder(BorderFactory.createEtchedBorder(), "专家评审", TitledBorder.CENTER, TitledBorder.TOP, new Font(    "宋体", Font.BOLD, 15), Color.BLUE));    this.colCount = 3;    init();    this.eidtNode = evalFormulaTreeNode;    addSubPane();    refreshData(eidtNode);  }  public void refreshData(EvalFormulaTreeNode evalFormulaTreeNode) {    eidtNode = evalFormulaTreeNode;    zcEbEvalItemResult = evalFormulaTreeNode.getUserObject();    setEditingObject(zcEbEvalItemResult);    setEditAble();    addListener();    refreshSubTableData();  }  abstract void setEditAble();  abstract void addListener();  private void addSubPane() {    //下面一句是为了打开word后刷新窗口    self.setSize(self.getSize().width + 1, self.getSize().height + 1);    wordPane.addPropertyChangeListener(WordPane.EVENT_NAME_OPEN_CALLBACK, new PropertyChangeListener() {      public void propertyChange(PropertyChangeEvent evt) {        //打开文件完成之后的回调函数        boolean isSuccess = (Boolean) evt.getNewValue();        if (isSuccess) {          //下面一句是为了打开word后刷新窗口          self.setSize(self.getSize().width - 1, self.getSize().height - 1);        }      }    });    tabPane.addTab("投标文件", wordPane);  }  private void refreshSubTableData() {    //获得该指标对应的投标文件Id：    String fileID = zcEbEvalItemResult.getResponseCode();    WordFileUtil.setDir("evalItemFile");    if (getWordPane() != null) {      getWordPane().close();    }    downLoadZbFile(fileID);  }  public EvalFormulaTreePanel getTreePanel() {    return treePanel;  }  public void setTreePanel(EvalFormulaTreePanel treePanel) {    this.treePanel = treePanel;  }  public WordPane getWordPane() {    return wordPane;  }  public void setWordPane(WordPane wordPane) {    this.wordPane = wordPane;  }  private void downLoadZbFile(String fileId) {  }  private void downLoadTbFile() {  }  public void downloadFileIfNeed(String fileId) {    if (null == fileId) {      return;    }    File file = new File(fileId);    if (!file.exists()) {      downloadFile(file);    }  }  private void downloadFile(File file) {  }}