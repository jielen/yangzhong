var ocolorPopup=window.createPopup();var ecolorPopup=null;function colordialogmouseout(a){a.style.borderColor="";a.bgColor=""}function colordialogmouseover(a){a.style.borderColor="#0A66EE";a.bgColor="#EEEEEE"}function colordialogmousedown(a){ecolorPopup.value=a;ocolorPopup.document.body.blur()}function colordialogmore(){var a=dlgHelper.ChooseColorDlg(ecolorPopup.value);a=a.toString(16);if(a.length<6){var b="000000".substring(0,6-a.length);a=b.concat(a)}ecolorPopup.value="#"+a.toUpperCase();ocolorPopup.document.body.blur()}function colordialog(c,a){var h=event.srcElement;h.onkeyup=colordialog;ecolorPopup=h;var b;var g=ocolorPopup.document.body;var f=new Array(40);g.style.backgroundColor="#f9f8f7";g.style.border="solid #999999 1px";g.style.fontSize="12px";f[0]="#000000";f[1]="#993300";f[2]="#333300";f[3]="#003300";f[4]="#003366";f[5]="#000080";f[6]="#333399";f[7]="#333333";f[8]="#800000";f[9]="#FF6600";f[10]="#808000";f[11]="#008000";f[12]="#008080";f[13]="#0000FF";f[14]="#666699";f[15]="#808080";f[16]="#FF0000";f[17]="#FF9900";f[18]="#99CC00";f[19]="#339966";f[20]="#33CCCC";f[21]="#3366FF";f[22]="#800080";f[23]="#999999";f[24]="#FF00FF";f[25]="#FFCC00";f[26]="#FFFF00";f[27]="#00FF00";f[28]="#00FFFF";f[29]="#00CCFF";f[30]="#993366";f[31]="#CCCCCC";f[32]="#FF99CC";f[33]="#FFCC99";f[34]="#FFFF99";f[35]="#CCFFCC";f[36]="#CCFFFF";f[37]="#99CCFF";f[38]="#CC99FF";f[39]="#FFFFFF";b="";b+="<table CELLPADDING=0 CELLSPACING=3>";b+='<tr height="20" width="20"><td align="center"><table style="border:1px solid #808080;" width="12" height="12" bgcolor="'+h.value+'"><tr><td></td></tr></table></td><td bgcolor="eeeeee" colspan="7" style="font-size:12px;" align="center">当前颜色</td></tr>';for(var d=0;d<f.length;d++){if(d%8==0){b+="<tr>"}b+='<td width="14" height="16" style="border:1px solid;" onMouseOut="parent.colordialogmouseout(this);" onMouseOver="parent.colordialogmouseover(this);" onMouseDown="parent.colordialogmousedown(\''+f[d]+'\')" align="center" valign="middle"><table style="border:1px solid #808080;" width="12" height="12" bgcolor="'+f[d]+'"><tr><td></td></tr></table></td>';if(d%8==7){b+="</tr>"}}b+='<tr><td align="center" height="22" colspan="8" onMouseOut="parent.colordialogmouseout(this);" onMouseOver="parent.colordialogmouseover(this);" style="border:1px solid;font-size:12px;cursor:default;" onMouseDown="parent.colordialogmore()">其它颜色</td></tr>';b+="</table>";g.innerHTML=b;ocolorPopup.show(c+h.offsetLeft,a+h.offsetTop+h.offsetHeight,158,147,document.body)};