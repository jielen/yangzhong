Ext.form.FileUploadField=Ext.extend(Ext.form.TextField,{buttonText:"Browse...",buttonOnly:false,buttonOffset:3,readOnly:true,autoSize:Ext.emptyFn,width:80,fileInput:null,initComponent:function(){Ext.form.FileUploadField.superclass.initComponent.call(this);this.addEvents("fileselected")},onRender:function(c,a){Ext.form.FileUploadField.superclass.onRender.call(this,c,a);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-file-wrap"});this.el.addClass("x-form-file-text");this.el.dom.removeAttribute("name");var b=Ext.applyIf(this.buttonCfg||{},{text:this.buttonText});this.button=new Ext.Button(Ext.apply(b,{renderTo:this.wrap,cls:"x-form-file-btn"+(b.iconCls?" x-btn-icon":"")}));if(this.buttonOnly){this.el.hide();this.wrap.setWidth(this.button.getEl().getWidth())}this.reset()},getFileInputId:function(){return this.id+"-file"},reset:function(){if(this.fileInput){if(this.fileInput.dom.value){this.fileInput.un("change");this.fileInput.remove();this.fileInput=null;this.el.dom.value=""}else{return}}this.fileInput=this.wrap.createChild({id:this.getFileInputId(),name:this.name||this.getId(),cls:"x-form-file",tag:"input",type:"file",size:1});this.fileInput.on("change",function(){var a=this.fileInput.dom.value;this.setValue(a);this.fireEvent("fileselected",this,a)},this)},onResize:function(a,b){Ext.form.FileUploadField.superclass.onResize.call(this,a,b);if(!this.width){this.width=a+80}this.onResizeComm(a)},onResizeComm:function(b){this.wrap.setWidth(b);if(!this.buttonOnly){var a=this.button.getEl().getWidth();a=(a<1)?80:a;var b=this.width-a-this.buttonOffset;this.el.setWidth(b)}},onShow:function(){Ext.form.FileUploadField.superclass.onShow.call(this);this.onResizeComm(this.width);this.wrap.show()},onHide:function(){this.wrap.setWidth(0);this.wrap.hide();Ext.form.FileUploadField.superclass.onHide.call(this)},preFocus:Ext.emptyFn,getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}});Ext.reg("fileuploadfield",Ext.form.FileUploadField);